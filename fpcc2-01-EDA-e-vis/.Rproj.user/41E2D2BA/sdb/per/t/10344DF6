{
    "contents" : "---\ntitle: \"tsne-jazz\"\n---\n\n```{r, message= FALSE, warning= FALSE}\nrequire(ggplot2)\nrequire(Rtsne)\nlibrary(reshape2)\nrequire(dplyr)\n```\n\n# Load the data\n```{r}\nTSNE.In.ArtistMap <- read.delim(\"ismir-data/Paper-Collab/JazzResults/30/ProbZ_Given_U.dat\", quote=\"\")\n```\n\n# Explore\n\nRandom 5K:\n\n```{r}\nrequire(rCharts)\nsmall <- TSNE.In.ArtistMap[sample(1:NROW(TSNE.In.ArtistMap), 1000),]\nsmall$V1 <- factor(small$V1)\n\nsmall.long <- melt(small, id.vars = c(\"V1\"))\nsmall.long$gene_index <- as.numeric(small.long$variable)\n\nggplot(small.long, aes(x = gene_index, y = sqrt(value), group = V1)) + \n  geom_line(alpha = 0.2, colour = \"darkorange\") + \n  theme(legend.position=\"none\") + \n  theme_bw()\n\n```\n\nAll: \n\n```{r}\ngenes.long <- melt(TSNE.In.ArtistMap, id.vars = \"X\")\nnames(genes.long) <- c(\"artist\", \"gene\", \"value\")\ngenes.long$artist <- factor(genes.long$artist)\nlevels(genes.long$gene) <- paste0(\"gene\", 1:NCOL(TSNE.In.ArtistMap) - 1)\ndominants <- genes.long %>% \n  group_by(artist) %>% \n  summarise(dominant = gene[which.max(value)], value = max(value))\n\nsummary(dominants)\n\ndominants %>% \n  filter(dominant == \"gene28\") %>% \n  arrange(desc(value)) %>% \n  head()\n```\n\n# t-SNE-ing\n\n## Small sample first\n\n```{r}\nsmall <- TSNE.In.ArtistMap[sample(1:NROW(TSNE.In.ArtistMap), 5e3),]\ntsne_full_small = Rtsne(small[,2:NCOL(TSNE.In.ArtistMap)], \n                 #perplexity = 10,\n                 max_iter = 1000,\n                 verbose = TRUE,\n                 check_duplicates = FALSE)\nggplot(as.data.frame(tsne_full_small$Y), aes(x = V1, y = V2)) + \n  geom_point(alpha = 0.6, size = 1.2, color = \"darkorange\") + \n  theme_bw()\n\n```\n\n## The whole thing\n\n```{r}\ntsne_full = Rtsne(TSNE.In.ArtistMap[,2:NCOL(TSNE.In.ArtistMap)], \n                 #perplexity = 10,\n                 max_iter = 1000,\n                 verbose = TRUE,\n                 check_duplicates = FALSE)\n\nggplot(as.data.frame(tsne_full$Y), aes(x = V1, y = V2)) + \n  geom_point(alpha = 0.5, size = 1.2, color = \"tomato\") + \n  theme_bw()\n\ntsnedf <- as.data.frame(tsne_full$Y)\ntsnedf$artist <- factor(TSNE.In.ArtistMap$X)\ntsnedf <- left_join(tsnedf, as.data.frame(dominants), by = \"artist\") \n\nwrite.csv(tsnedf, file = \"tsne-collabs-jazz.csv\")\n\ntop_collabs <- tsnedf %>% \n  group_by(dominant) %>% \n  summarise(value = max(value), \n            V1 = V1[which.max(value)], \n            V2 = V2[which.max(value)])\n\nggplot(as.data.frame(tsnedf), aes(x = V1, y = V2, colour = dominant)) + \n  geom_point(alpha = 0.2, size = 1.5) + \n  theme_bw() +\n  geom_text(data = top_collabs, \n            aes(x = V1, y = V2, label = dominant, colour = dominant), \n            size = 2.5, \n            alpha = 1) + \n  theme(legend.position=\"none\")\n  \n```\n\nGenes with Miles: 39, 20, 38, 43, 1, 19, 14, 21, 28, 2 \n19 seems to be late in the career. \n21 has jim hall, chet baker, gerry mulligan\n\nWith Ornette Coleman: 3, \nThis is Ornette plus swedish jazz players as targets.\nAs sources, Don Cherry lived in sweden for 20 years. \n\n\n```{r}\n# gene with Ornette as target (in the summary): \nzoomed <- tsnedf %>% filter(dominant == \"gene3\", value > .1, V2 > 30)\nggplot(as.data.frame(zoomed), aes(x = V1, y = V2, colour = artist == \"Eric Dolphy\", label = artist)) + \n  geom_point(alpha = 0.6, size = 2) + \n  geom_text(size = 2.5) + \n  theme_bw()\n\n```\n\nGene 0 is early jazz players: \n\n```{r}\n\nzoomed <- tsnedf %>% filter(dominant == \"gene0\", value > .05, V1 < 20, V2 < 20)\nggplot(as.data.frame(zoomed), aes(x = V1, y = V2, colour = dominant, label = artist)) + \n  geom_point(alpha = 0.4, size = 3) + \n  geom_text(zoomed[sample(1:NROW(zoomed), 100),], aes(x = V1, y = V2, label = artist), size = 2.5) + \n  theme_bw()\n\n```\n\n\nLouis Armstrong 0.106488535279\nSidney Bechet 0.0382881659437\nLouis Armstrong And His Orchestra 0.0313484792395\nJelly Roll Morton 0.0236908939106\nBenny Carter 0.0186656035386\nHenry Red Allen 0.0150761104157\nColeman Hawkins 0.0138796127081\nJimmie Lunceford And His Orchestra 0.0126831150004  \nLouis Armstrong & His Hot Five 0.0124438154589\nDon Redman 0.0122045159174\n\n\nGene 14 is the odd bebop people: \nCharles Mingus 0.130876921803\nMax Roach 0.0333699022925\nThe Sun Ra Arkestra 0.0322983965836\nMiles Davis 0.0303084574099\nEric Dolphy 0.0194403280767\nGil Evans And His Orchestra 0.0182157501237\nJohn Coltrane 0.0182157501237\nFreddie Hubbard 0.0154604497293\nDuke Ellington 0.012705149335\nMcCoy Tyner 0.0113274991378\n\nGene 30 parece ser Jazz Funk. \n\nThe Horace Silver Quintet 0.0572536424803\nJimmy Smith 0.0428717810483\nDonald Byrd 0.0379408571288\nFreddie Hubbard 0.0276680989631\nKenny Burrell 0.0238329359145\nLou Donaldson 0.0236959658057\nStanley Turrentine 0.0228741451524\nBrother Jack McDuff 0.0201347429749\nLee Morgan 0.0191759522128\nJackie McLean 0.0162995799264\n\n",
    "created" : 1459393457242.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1354976635",
    "id" : "10344DF6",
    "lastKnownWriteTime" : 1458955776,
    "path" : "~/workspace/ismir2016/tsne-jazz.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}